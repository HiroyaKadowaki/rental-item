<%= render "devise/shared/header" %>

<div class='items-main'>
  <div class='item-show'>
    <h2><%= @category.name %></h2>
  </div>
  <% if @items.exists? %>
    <h2 class='title'>備品一覧</h2>
    <div class='item-title'>
      <div class='item-number'>
        <h4>備品番号</h4>
      </div>
      <div class='item-name'>
        <h4>備品の名前</h4>
      </div>
      <div class='item-rental'>
        <h4>貸し出し状況</h4>
      </div>
    </div>
    <% @items.each do |item| %>
      <ul class="item-summary">
        <li class='item-lists'>
          <div class='item-number'>
            <%= item.number %>
          </div>
          <div class='item-name'>
            <%= link_to item.name, item_path(item), class:'item-link' %>
          </div>
          <div class='item-rental'>
            <% if item.rental != nil %>
              <% if current_user.id == item.rental.user_id %>
                <%= link_to "返却", item_rental_path(item.rental.item_id, item.rental.id), method: :delete, class:'on-loan' %>
              <% else %>
                <%= link_to "貸し出し中", user_path(item.rental.user_id), class:'on-loan' %>
              <% end %>
            <% else %>
              <%= form_with model: @rental, url: item_rentals_path(item.id), local: true do |f| %>
                <%= f.submit "貸し出し可" ,class:'rental-path' %>
              <% end %>
            <% end %>
          </div>
        </li>
      </ul>
    <% end %>
    <div class='how'>
      <%= "※『貸し出し可』を押すと貸し出しできます" %>
    </div>
    <div class='how'>
      <%= "※『貸し出し可』を押すと貸し出しできます" %>
    </div>
  <% else %>
  <h2>備品を登録してください</h2>
  <% end %>
</div>

<div class="switch">
  <%= link_to '編集', edit_category_path, method: :get, class: "item-switch" %>
  <%= link_to '削除', category_path, method: :delete, class:'item-switch' %>
  <%=link_to 'ホームにもどる', root_path, class:"item-switch" %>
</div>

<%= render "devise/shared/footer" %>
